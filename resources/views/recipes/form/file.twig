{% if key is not defined %}
    {% set key = 0 %}
{% endif %}

<div class="form-row file">
    <div class="col-md-12">
        <div class="form-row mb-2">
            <div class="col-md-11">
                {% set placeholder = 'Add File (Optional)' %}
                {% if file.path is not empty %}
                    {% set placeholder = file.path %}
                    {{ form.hidden( 'files[' ~ key ~ '][path]', old( 'files[' ~ key ~ '][path]', file.path ), { class: 'path' } ) }}
                {% endif %}
                {{ form.file( 'files[' ~ key ~ '][file]', '', 'custom-file-input recipe-file', placeholder, false, { disabled: ( file.path is not empty ? true : false ) } ) }}
                {{ form.hidden( 'files[' ~ key ~ '][type]', old( 'files[' ~ key ~ '][type]', 'file' ), { class: 'type' } ) }}
                {{ form.hidden( 'files[' ~ key ~ '][id]', old( 'files[' ~ key ~ '][id]', file.id ), { class: 'id' } ) }}
            </div>
            <div class="col-md-1 pl-1 pr-1">
                <span class="btn btn-light sort-item w-100">&#9776;</span>
            </div>
        </div>
        <div class="form-row mb-2">
            <div class="col-md-11">
                {{ form.textarea( 'files[' ~ key ~ '][caption]', old( 'files[' ~ key ~ '][caption]', file.caption ), '', 'file-caption', 'File Description', false, 2 ) }}
            </div>
            <div class="col-md-1 pl-1 pr-1">
                <span class="btn btn-danger remove-item w-100" data-row="{{ key }}">X</span>
            </div>
        </div>
    </div>
</div>
